# Система компьютерного зрения для FPV

Этот проект реализует продвинутую систему компьютерного зрения для FPV (First Person View) приложений с использованием нейронной сети YOLOv8. Система обеспечивает обнаружение объектов в реальном времени, их отслеживание и оценку расстояния.

## Основные возможности

- Захват видео в реальном времени через веб-камеру
- Обнаружение объектов с помощью нейросети YOLOv8
- Отслеживание нескольких объектов с уникальными ID
- Визуализация траектории движения объектов
- Оценка расстояния до объектов
- Поддержка более 80 классов объектов
- Отображение информации в реальном времени
- Адаптивное улучшение изображения при плохом освещении
- Автоматическая настройка яркости и контраста
- Шумоподавление для улучшения качества распознавания

## Системные требования

- Веб-камера
- Python 3.7 или новее
- Windows/Linux
- Рекомендуется видеокарта с поддержкой CUDA (для ускорения работы)

## Необходимые библиотеки

- OpenCV - для работы с видео
- PyTorch - для работы нейросети
- Ultralytics YOLOv8 - для распознавания объектов
- NumPy - для математических вычислений
- imutils - для обработки изображений

## Установка

1. Установите Python 3.7 или новее версии

2. Установите все необходимые библиотеки:
```bash
pip install -r requirements.txt
```

3. При первом запуске программа автоматически загрузит веса модели YOLOv8

## Использование

1. Подключите веб-камеру к компьютеру

2. Запустите программу:
```bash
python fpv_vision.py
```

3. Программа будет:
   - Инициализировать модель YOLOv8
   - Начать захват видео с камеры
   - Автоматически улучшать качество изображения при плохом освещении
   - Обнаруживать и отслеживать объекты в реальном времени
   - Показывать рамки вокруг объектов
   - Отображать название объекта и уверенность определения
   - Показывать примерное расстояние до объектов
   - Отображать траекторию движения объектов
   - Показывать текущий уровень освещенности

4. Для выхода из программы нажмите клавишу 'q'

## Описание функций

- **Обнаружение объектов**: 
  - Использует YOLOv8 для определения более 80 различных типов объектов
  - Показывает процент уверенности в определении
  - Выделяет объекты зеленой рамкой

- **Отслеживание объектов**: 
  - Присваивает каждому объекту уникальный ID
  - Сохраняет историю перемещений
  - Отображает траекторию движения желтой линией

- **Оценка расстояния**: 
  - Вычисляет примерное расстояние до объекта
  - Использует параметры камеры и размер объекта
  - Показывает расстояние в сантиметрах

- **Улучшение изображения**:
  - Автоматическое определение уровня освещенности
  - Адаптивное повышение яркости при плохом освещении
  - Улучшение контраста с помощью CLAHE
  - Интеллектуальное шумоподавление
  - Сохранение цветового баланса


